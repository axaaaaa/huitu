<!DOCTYPE html>
<html lang="zh-CN" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ç»˜ç”»é£æ ¼å›¾é‰´ - ç»ˆææ•´åˆç‰ˆ</title>
    <style>
        /* --- CSS å˜é‡ & ä¸»é¢˜å®šä¹‰ --- */
        :root {
            --bg-color: #0f0f0f;
            --card-bg: #1a1a1a;
            --text-main: #ececec;
            --text-sub: #a0a0a0;
            --accent-color: #00e5ff; /* èµ›åšè“ */
            --card-border: #333;
            --search-bg: #252525;
            --input-border: #444;
        }

        [data-theme="light"] {
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --text-main: #333333;
            --text-sub: #666666;
            --accent-color: #6200ea; /* æ·±ç´«è‰² */
            --card-border: #dcdcdc;
            --search-bg: #ffffff;
            --input-border: #ccc;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; transition: background-color 0.3s, border-color 0.3s, color 0.3s; }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            line-height: 1.6;
            padding: 20px;
            padding-bottom: 80px;
        }

        .container { max-width: 1400px; margin: 0 auto; }

        /* --- é¡¶éƒ¨ Header & å·¥å…·æ  --- */
        header {
            padding: 20px 0;
            margin-bottom: 30px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--card-border);
        }

        h1 {
            font-size: 2rem;
            background: linear-gradient(90deg, var(--accent-color), #ff0080);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }

        .theme-toggle {
            background: var(--search-bg);
            border: 1px solid var(--input-border);
            color: var(--text-main);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .theme-toggle:hover { border-color: var(--accent-color); }

        /* å·¥å…·æ  */
        .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--card-border);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .tool-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
            flex: 1;
            min-width: 180px;
        }

        .tool-group label { font-size: 0.8rem; color: var(--text-sub); font-weight: bold; }

        input, select {
            background: var(--search-bg);
            border: 1px solid var(--input-border);
            color: var(--text-main);
            padding: 10px;
            border-radius: 8px;
            outline: none;
            font-size: 0.9rem;
        }
        input:focus, select:focus { border-color: var(--accent-color); }

        /* --- ç½‘æ ¼ & å¡ç‰‡ --- */
        .section-title {
            font-size: 1.5rem;
            margin: 40px 0 15px 0;
            padding-left: 15px;
            border-left: 5px solid var(--accent-color);
            color: var(--text-main);
        }

        .category-title {
            font-size: 1.1rem;
            color: var(--text-sub);
            margin: 20px 0 10px 0;
            border-bottom: 1px solid var(--card-border);
            padding-bottom: 5px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 15px;
        }

        .style-card {
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
            transition: transform 0.2s;
        }

        .style-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-color);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 2;
        }

        /* å›¾ç‰‡åŒºåŸŸ */
        .img-wrapper {
            width: 100%;
            aspect-ratio: 1 / 1;
            background-color: var(--search-bg);
            position: relative;
            cursor: zoom-in; /* æç¤ºå¯æ”¾å¤§ */
            overflow: hidden;
        }

        .img-wrapper img {
            width: 100%; height: 100%; object-fit: cover;
            opacity: 0; transition: opacity 0.4s ease;
        }
        .img-wrapper img.loaded { opacity: 1; }

        /* æ‚¬åœæ˜¾ç¤ºæ”¾å¤§é•œ */
        .img-wrapper:hover::after {
            content: "ğŸ”";
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5rem;
            text-shadow: 0 2px 10px rgba(0,0,0,0.8);
            opacity: 1;
            pointer-events: none;
        }

        .loading-spinner {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 25px; height: 25px;
            border: 3px solid var(--text-sub);
            border-top-color: var(--accent-color);
            border-radius: 50%;
            animation: spin 0.8s infinite linear;
        }
        @keyframes spin { to { transform: translate(-50%, -50%) rotate(360deg); } }

        /* æ–‡å­—åŒºåŸŸ */
        .card-label {
            padding: 10px 8px;
            font-size: 0.85rem;
            text-align: center;
            font-weight: 600;
            color: var(--text-main);
            background: var(--card-bg);
            cursor: pointer;
            border-top: 1px solid var(--card-border);
        }
        .card-label:hover {
            background-color: var(--accent-color);
            color: #fff;
        }

        /* --- ç¯ç®± (Lightbox) --- */
        .lightbox-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0; top: 0;
            width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.92);
            backdrop-filter: blur(5px);
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .lightbox-content {
            max-width: 90%;
            max-height: 80vh;
            border-radius: 4px;
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
            animation: zoomIn 0.3s;
        }
        @keyframes zoomIn { from {transform:scale(0.9); opacity:0} to {transform:scale(1); opacity:1} }

        .lightbox-caption {
            color: #fff; margin-top: 15px; font-size: 1.2rem; font-weight: bold;
        }

        .lightbox-actions { margin-top: 20px; display: flex; gap: 15px; }
        
        .btn-action {
            padding: 10px 25px;
            border-radius: 30px;
            border: 1px solid var(--accent-color);
            background: rgba(0,0,0,0.6);
            color: #fff; cursor: pointer;
            font-size: 1rem; transition: 0.3s;
        }
        .btn-action:hover { background: var(--accent-color); color: #000; }

        .close-btn {
            position: absolute; top: 20px; right: 40px;
            color: #fff; font-size: 50px; cursor: pointer;
        }

        /* --- Toast --- */
        #toast {
            visibility: hidden; min-width: 260px;
            background-color: var(--card-bg); color: var(--accent-color);
            text-align: center; border-radius: 50px; padding: 16px;
            position: fixed; z-index: 3000; left: 50%; bottom: 30px;
            transform: translateX(-50%);
            border: 1px solid var(--accent-color);
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            font-weight: bold; opacity: 0; transition: all 0.3s;
        }
        #toast.show { visibility: visible; opacity: 1; bottom: 60px; }

        footer { text-align: center; margin-top: 60px; color: var(--text-sub); font-size: 0.9rem; }

        @media (max-width: 768px) {
            .header-top, .toolbar { flex-direction: column; }
            .close-btn { top: 10px; right: 20px; font-size: 40px; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="header-top">
            <h1>ğŸ¨ AI ç»˜ç”»é£æ ¼å›¾é‰´ <span style="font-size:0.4em; opacity:0.6; border:1px solid currentColor; border-radius:4px; padding:2px 5px; vertical-align: middle;">Ultimate</span></h1>
            <button class="theme-toggle" id="themeBtn">
                <span id="themeIcon">â˜€ï¸</span> åˆ‡æ¢ä¸»é¢˜
            </button>
        </div>

        <div class="toolbar">
            <div class="tool-group" style="flex: 1.2;">
                <label>ğŸ“‹ å¿«æ·æ¨¡ç‰ˆ (Templates)</label>
                <select id="presetSelect" onchange="applyPreset()">
                    <option value="chat_cn" selected>ğŸ‡¨ğŸ‡³ ä¸­æ–‡æŒ‡ä»¤ (è¯·ç”Ÿæˆ...)</option>
                    <option value="chat_en">ğŸ‡ºğŸ‡¸ è‹±æ–‡æŒ‡ä»¤ (Please generate...)</option>
                    <option value="sd_base">ğŸ¨ SD/MJ é€šç”¨ (Masterpiece...)</option>
                    <option value="custom">âš™ï¸ è‡ªå®šä¹‰ (Custom)</option>
                    <option value="empty">âŒ æ¸…ç©º (Empty)</option>
                </select>
            </div>

            <div class="tool-group" style="flex: 2;">
                <label>ğŸ” æœç´¢é£æ ¼ (Search)</label>
                <input type="text" id="searchInput" placeholder="è¾“å…¥å…³é”®è¯ï¼Œå¦‚ 'Pixel', 'èµ›åš'...">
            </div>

            <div class="tool-group" style="flex: 1.5;">
                <label>å‰ç¼€ (Prefix)</label>
                <input type="text" id="prefixInput">
            </div>
            <div class="tool-group" style="flex: 1.5;">
                <label>åç¼€ (Suffix)</label>
                <input type="text" id="suffixInput">
            </div>
        </div>
    </header>

    <div id="gallery-root"></div>

    <footer>
        <p>å·²é›†æˆ 200+ é£æ ¼ Â· ç‚¹å‡»å›¾ç‰‡é¢„è§ˆå¤§å›¾ Â· ç‚¹å‡»æ–‡å­—å¤åˆ¶æç¤ºè¯</p>
    </footer>
</div>

<div id="lightbox" class="lightbox-modal">
    <span class="close-btn" onclick="closeLightbox()">&times;</span>
    <img class="lightbox-content" id="lightbox-img">
    <div class="lightbox-caption" id="lightbox-caption">Title</div>
    <div class="lightbox-actions">
        <button class="btn-action" onclick="copyCurrentFromLightbox()">ğŸ“‹ å¤åˆ¶ Prompt</button>
        <button class="btn-action" onclick="closeLightbox()">âŒ å…³é—­</button>
    </div>
</div>

<div id="toast">å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼</div>

<script>
    // ==============================================
    // ğŸ¨ 200+ å®Œæ•´é£æ ¼æ•°æ®åº“
    // ==============================================
    const styleData = [
        {
            title: "â… . ä¼ ç»Ÿè‰ºæœ¯æµæ´¾ (Classic Art Movements)",
            categories: [
                {
                    name: "1. å¤å…¸ä¸å†™å®",
                    tags: ["Classicism (å¤å…¸ä¸»ä¹‰)", "Realism (å†™å®ä¸»ä¹‰)", "Academic Art (å­¦é™¢æ´¾)", "Baroque (å·´æ´›å…‹)", "Rococo (æ´›å¯å¯)", "Neoclassicism (æ–°å¤å…¸ä¸»ä¹‰)", "Renaissance (æ–‡è‰ºå¤å…´)", "Pre-Raphaelite (å‰æ‹‰æ–å°”æ´¾)", "Mannerism (çŸ«é¥°ä¸»ä¹‰)"]
                },
                {
                    name: "2. å°è±¡ä¸æµªæ¼«",
                    tags: ["Romanticism (æµªæ¼«ä¸»ä¹‰)", "Impressionism (å°è±¡æ´¾)", "Post-Impressionism (åå°è±¡æ´¾)", "Pointillism (ç‚¹ææ´¾)", "Luminism (å…‰ç¿æ´¾)"]
                },
                {
                    name: "3. ç°ä»£è‰ºæœ¯æ—©æœŸ",
                    tags: ["Art Nouveau (æ–°è‰ºæœ¯è¿åŠ¨)", "Art Deco (è£…é¥°è‰ºæœ¯)", "Bauhaus (åŒ…è±ªæ–¯)", "Cubism (ç«‹ä½“ä¸»ä¹‰)", "Fauvism (é‡å…½æ´¾)", "Expressionism (è¡¨ç°ä¸»ä¹‰)", "Abstract Expressionism (æŠ½è±¡è¡¨ç°ä¸»ä¹‰)", "Dadaism (è¾¾è¾¾ä¸»ä¹‰)", "Futurism (æœªæ¥ä¸»ä¹‰)", "Surrealism (è¶…ç°å®ä¸»ä¹‰)", "Suprematism (è‡³ä¸Šä¸»ä¹‰)"]
                },
                {
                    name: "4. ä¸œæ–¹è‰ºæœ¯",
                    tags: ["Ink Wash Painting (ä¸­å›½æ°´å¢¨)", "Gongbi (å·¥ç¬”ç”»)", "Shan Shui (å±±æ°´ç”»)", "Ukiyo-e (æ—¥æœ¬æµ®ä¸–ç»˜)", "Japanese Traditional (ä¸œç€›é£)", "Chinese-NewWave (å›½æ½®é£)", "Mughal Painting (è«å§å„¿ç»†å¯†ç”»)", "Thangka (å”å¡é£æ ¼)"]
                }
            ]
        },
        {
            title: "â…¡. æ’ç”»ä¸å¹³é¢è®¾è®¡ (Illustration & Design)",
            categories: [
                {
                    name: "5. ç°ä»£è®¾è®¡é£",
                    tags: ["Flat Design (æ‰å¹³åŒ–)", "Minimalism (æç®€ä¸»ä¹‰)", "Material Design (ææ–™è®¾è®¡)", "Memphis Design (å­Ÿè²æ–¯é£æ ¼)", "Swiss Style (ç‘å£«å›½é™…ä¸»ä¹‰)", "Brutalism (ç²—é‡ä¸»ä¹‰è®¾è®¡)", "Psychedelic Art (è¿·å¹»è‰ºæœ¯)", "Pop Art (æ³¢æ™®è‰ºæœ¯)", "Op Art (æ¬§æ™®è‰ºæœ¯)"]
                },
                {
                    name: "6. æ’ç”»æŠ€æ³•",
                    tags: ["Line Art (çº¿æ¡è‰ºæœ¯)", "Doodle (æ¶‚é¸¦é£)", "Vector Art (çŸ¢é‡æ’ç”»)", "Risograph (å­”ç‰ˆå°åˆ·)", "Collage (æ‹¼è´´è‰ºæœ¯)", "Sticker Art (è´´çº¸é£æ ¼)", "Stencil Art (å–·æ¼†æ¨¡ç‰ˆ)", "Ligne Claire (æ¸…æ™°çº¿æ¡/ä¸ä¸å†é™©è®°é£)", "Lowbrow (ä½çœ‰è‰ºæœ¯)", "Children's Book Illustration (ç»˜æœ¬é£)"]
                },
                {
                    name: "7. æ¼«ç”»ä¸äºŒæ¬¡å…ƒ",
                    tags: ["Anime Style (æ—¥ç³»åŠ¨æ¼«)", "Manga (é»‘ç™½æ—¥æ¼«)", "Vintage Anime 90s (90å¹´ä»£èµ›ç’ç’)", "Studio Ghibli (å‰åœåŠ›é£æ ¼)", "Makoto Shinkai (æ–°æµ·è¯šé£æ ¼)", "Comic Book (ç¾å¼æ¼«ç”»)", "DC Comics Style (DCé£æ ¼)", "Marvel Comics Style (æ¼«å¨é£æ ¼)", "Webtoon (éŸ©æ¼«æ¡æ¼«)", "Chibi (Qç‰ˆå¤§å¤´)"]
                }
            ]
        },
        {
            title: "â…¢. æ‘„å½±ä¸å…‰å½± (Photography & Lighting)",
            categories: [
                {
                    name: "8. é•œå¤´ä¸æŠ€æ³•",
                    tags: ["Photorealistic (ç…§ç‰‡çº§å†™å®)", "Macro Photography (å¾®è·æ‘„å½±)", "Bokeh (å¤§å…‰åœˆè™šåŒ–)", "Tilt-Shift (ç§»è½´æ‘„å½±)", "Fish-eye Lens (é±¼çœ¼é•œå¤´)", "Long Exposure (é•¿æ›å…‰)", "Double Exposure (åŒé‡æ›å…‰)", "Drone Photography (æ— äººæœºèˆªæ‹)", "Polaroid (å®ä¸½æ¥é£æ ¼)", "GoPro Footage (è¿åŠ¨ç›¸æœºè§†è§’)"]
                },
                {
                    name: "9. å…‰å½±æ°›å›´",
                    tags: ["Cinematic Lighting (ç”µå½±å¸ƒå…‰)", "Rembrandt Lighting (ä¼¦å‹ƒæœ—å…‰)", "Volumetric Lighting (ä½“ç§¯å…‰/ä¸è¾¾å°”æ•ˆåº”)", "Neon Noir (éœ“è™¹é»‘è‰²ç”µå½±)", "Golden Hour (é»„é‡‘æ—¶åˆ»)", "Blue Hour (è“è°ƒæ—¶åˆ»)", "Silhouette (å‰ªå½±)", "Rim Light (è½®å»“å…‰)"]
                }
            ]
        },
        {
            title: "â…£. æ¸¸æˆä¸3Dæ¸²æŸ“ (Game & 3D)",
            categories: [
                {
                    name: "10. æ¸¸æˆä¸–ä»£",
                    tags: ["Pixel Art (åƒç´ é£)", "8-bit (8ä½æœºé£æ ¼)", "16-bit (16ä½æœºé£æ ¼)", "PS1 Graphics (PS1å¤å¤3D)", "Low Poly (ä½å¤šè¾¹å½¢)", "Voxel Art (ä½“ç´ é£)", "Isometric View (ç­‰è·è§†è§’)", "Visual Novel (è§†è§‰å°è¯´)"]
                },
                {
                    name: "11. ç°ä»£å¼•æ“ä¸æè´¨",
                    tags: ["Unreal Engine 5 (è™šå¹»å¼•æ“5)", "Octane Render (OCæ¸²æŸ“)", "Ray Tracing (å…‰çº¿è¿½è¸ª)", "PBR Materials (PBRç‰©ç†æè´¨)", "Claymorphism (ç²˜åœŸé£)", "Glassmorphism (ç»ç’ƒæ‹Ÿæ€)", "Knolling (å¹³é“ºæ‘„å½±)", "Diorama (é€è§†å¾®ç¼©æ¨¡å‹)"]
                }
            ]
        },
        {
            title: "â…¤. æè´¨ä¸ç‰¹æ®Šå·¥è‰º (Materials & Crafts)",
            categories: [
                {
                    name: "12. ä¼ ç»Ÿå·¥è‰º",
                    tags: ["Origami (æŠ˜çº¸è‰ºæœ¯)", "Paper Cut Craft (å‰ªçº¸é£)", "Stained Glass (å½©è‰²èŠ±çª—ç»ç’ƒ)", "Mosaic (é©¬èµ›å…‹æ‹¼è´´)", "Embroidery (åˆºç»£é£æ ¼)", "Felt Art (ç¾Šæ¯›æ¯¡)", "Wood Carving (æœ¨é›•)", "Ceramic (é™¶ç“·è´¨æ„Ÿ)"]
                },
                {
                    name: "13. ç‰¹æ®Šæè´¨",
                    tags: ["Liquid Metal (æ¶²æ€é‡‘å±)", "Smoke Art (çƒŸé›¾è‰ºæœ¯)", "Water Splash (æ°´èŠ±é£æº…)", "Crystal (æ°´æ™¶è´¨æ„Ÿ)", "Glitch Art (æ•…éšœè‰ºæœ¯)", "Neon Light (éœ“è™¹ç¯ç®¡)", "Holographic (å…¨æ¯æè´¨)", "X-Ray (Xå…‰é€è§†)"]
                }
            ]
        },
        {
            title: "â…¥. ç§‘å¹»ä¸å¹»æƒ³ (Sci-Fi & Fantasy)",
            categories: [
                {
                    name: "14. æœ‹å…‹å®¶æ—",
                    tags: ["Cyberpunk (èµ›åšæœ‹å…‹)", "Steampunk (è’¸æ±½æœ‹å…‹)", "Dieselpunk (æŸ´æ²¹æœ‹å…‹)", "Solarpunk (å¤ªé˜³æœ‹å…‹)", "Biopunk (ç”Ÿç‰©æœ‹å…‹)", "Atompunk (åŸå­æœ‹å…‹)", "Synthwave (åˆæˆæ³¢)", "Vaporwave (è’¸æ°”æ³¢)"]
                },
                {
                    name: "15. å¹»æƒ³æµæ´¾",
                    tags: ["Dark Fantasy (æš—é»‘å¥‡å¹»)", "High Fantasy (å²è¯—å¥‡å¹»)", "Eldritch (å…‹è‹é²/ä¸å¯åçŠ¶)", "Grimdark (å†·é…·é»‘æš—)", "Post-Apocalyptic (æœ«æ—¥åºŸåœŸ)", "Space Opera (å¤ªç©ºæ­Œå‰§)", "Mecha (æœºç”²é£)", "Biomechanical (ä»¿ç”Ÿæœºæ¢°)"]
                }
            ]
        },
        {
            title: "â…¦. å¯¼æ¼”ä¸ç”µå½±ç¾å­¦ (Director Styles)",
            categories: [
                {
                    name: "16. è‘—åå¯¼æ¼”é£æ ¼",
                    tags: ["Wes Anderson Style (éŸ¦æ–¯Â·å®‰å¾·æ£®/å¯¹ç§°ç²‰å½©)", "Tim Burton Style (è’‚å§†Â·æ³¢é¡¿/å“¥ç‰¹æ€ªè¯)", "Blade Runner Style (é“¶ç¿¼æ€æ‰‹é£)", "Tarantino Style (å¡”ä¼¦è’‚è¯º/æš´åŠ›ç¾å­¦)", "Kubrick Style (åº“å¸ƒé‡Œå…‹/æè‡´æ„å›¾)", "Dune Style (æ²™ä¸˜/å·¨ç‰©æç®€)", "Matrix Style (é»‘å®¢å¸å›½/ç»¿è°ƒ)"]
                }
            ]
        }
    ];

    // --- æ ¸å¿ƒæ¸²æŸ“é€»è¾‘ ---
    const root = document.getElementById('gallery-root');

    function renderGallery() {
        root.innerHTML = ''; // æ¸…ç©ºé˜²æ­¢é‡å¤
        
        styleData.forEach(section => {
            const sectionDiv = document.createElement('div');
            sectionDiv.className = 'section-container';
            
            const h2 = document.createElement('h2');
            h2.className = 'section-title';
            h2.textContent = section.title;
            sectionDiv.appendChild(h2);

            section.categories.forEach(cat => {
                const catDiv = document.createElement('div');
                catDiv.className = 'category-container';

                const h3 = document.createElement('h3');
                h3.className = 'category-title';
                h3.textContent = cat.name;
                catDiv.appendChild(h3);

                const grid = document.createElement('div');
                grid.className = 'grid-container';

                cat.tags.forEach(tagText => {
                    const promptName = tagText.split(' (')[0].trim();
                    // æ–‡ä»¶åè§„åˆ™: ç©ºæ ¼å˜ä¸‹åˆ’çº¿, å…¨å°å†™
                    const fileName = promptName.replace(/ /g, "_").replace(/\//g, "-").toLowerCase() + ".jpg";
                    const localPath = `images/${fileName}`;
                    // åœ¨çº¿å¤‡ç”¨ (å°å›¾)
                    const onlineUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent('masterpiece, ' + promptName + ' style visual art')}?width=320&height=320&nologo=true&model=flux&seed=66`;

                    const card = document.createElement('div');
                    card.className = 'style-card';
                    card.setAttribute('data-search', tagText.toLowerCase());

                    // ç»“æ„: å›¾ç‰‡åŒºåŸŸ(ç‚¹å‡»çœ‹å¤§å›¾) + æ–‡å­—åŒºåŸŸ(ç‚¹å‡»å¤åˆ¶)
                    card.innerHTML = `
                        <div class="img-wrapper" onclick="openLightbox('${localPath}', '${onlineUrl}', '${tagText}')">
                            <div class="loading-spinner"></div>
                            <img 
                                src="${localPath}" 
                                alt="${promptName}" 
                                loading="lazy" 
                                onload="this.classList.add('loaded'); this.previousElementSibling.style.display='none';"
                                onerror="this.onerror=null; this.src='${onlineUrl}';"
                            >
                        </div>
                        <div class="card-label" onclick="copyText('${tagText}')" title="ç‚¹å‡»å¤åˆ¶æç¤ºè¯">
                            ${tagText}
                        </div>
                    `;
                    grid.appendChild(card);
                });

                catDiv.appendChild(grid);
                sectionDiv.appendChild(catDiv);
            });
            root.appendChild(sectionDiv);
        });
    }

    // --- ç¯ç®± (Lightbox) é€»è¾‘ ---
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = document.getElementById('lightbox-img');
    const lightboxCaption = document.getElementById('lightbox-caption');
    let currentTagInLightbox = "";

    function openLightbox(localSrc, onlineSrc, tagText) {
        lightbox.style.display = "flex";
        lightboxCaption.innerText = tagText;
        currentTagInLightbox = tagText;
        
        lightboxImg.style.opacity = 0.5;
        lightboxImg.src = ""; // reset

        // é€»è¾‘: ä¼˜å…ˆå°è¯•æœ¬åœ°å›¾ç‰‡ã€‚å¦‚æœæœ¬åœ°å›¾ç‰‡ä¹‹å‰onerroräº†(åœ¨gridé‡Œ), æˆ‘ä»¬è¿™é‡Œè¿˜æ˜¯å°è¯•ä¸€ä¸‹
        // å¦‚æœæœ¬åœ°å¤±è´¥ï¼Œonerrorä¼šè§¦å‘å»åŠ è½½é«˜æ¸…åœ¨çº¿å›¾
        
        const hdOnlineUrl = onlineSrc.replace("width=320", "width=1024").replace("height=320", "height=1024");

        lightboxImg.src = localSrc;
        
        lightboxImg.onerror = function() {
            // æœ¬åœ°æŒ‚äº†ï¼ŒåŠ è½½é«˜æ¸…åœ¨çº¿å›¾
            this.src = hdOnlineUrl;
        }
        lightboxImg.onload = function() {
            this.style.opacity = 1;
        }
    }

    function closeLightbox() {
        lightbox.style.display = "none";
        lightboxImg.src = "";
    }
    function copyCurrentFromLightbox() {
        copyText(currentTagInLightbox);
    }

    // ç»‘å®šå…³é—­äº‹ä»¶
    window.onclick = (e) => { if(e.target == lightbox) closeLightbox(); }
    document.addEventListener('keydown', (e) => { if(e.key === "Escape") closeLightbox(); });

    // --- å¤åˆ¶ & æ¨¡ç‰ˆé€»è¾‘ ---
    function applyPreset() {
        const mode = document.getElementById('presetSelect').value;
        const p = document.getElementById('prefixInput');
        const s = document.getElementById('suffixInput');

        if(mode === 'chat_cn') { p.value = "è¯·å¸®æˆ‘ç”Ÿæˆä¸€å¼ "; s.value = "é£æ ¼çš„å›¾ç‰‡ï¼Œç”»é¢è¦ç²¾è‡´ï¼Œç»†èŠ‚ä¸°å¯Œ"; }
        else if(mode === 'chat_en') { p.value = "Please generate a"; s.value = "style image, high quality, detailed"; }
        else if(mode === 'sd_base') { p.value = "masterpiece, best quality,"; s.value = ", 8k, detailed, trending on artstation"; }
        else if(mode === 'empty') { p.value = ""; s.value = ""; }
        
        if(mode !== 'custom') {
            p.style.borderColor = 'var(--accent-color)';
            setTimeout(() => p.style.borderColor = '', 300);
        }
    }

    function copyText(tagText) {
        const styleName = tagText.split(' (')[0];
        const prefix = document.getElementById('prefixInput').value.trim();
        const suffix = document.getElementById('suffixInput').value.trim();
        
        let final = styleName;
        if(prefix) final = `${prefix} ${final}`; // æ™ºèƒ½ç©ºæ ¼
        if(suffix) final = `${final} ${suffix}`;

        navigator.clipboard.writeText(final).then(() => {
            const showText = final.length > 40 ? final.substring(0,40)+"..." : final;
            showToast(`å·²å¤åˆ¶: ${showText}`);
        });
    }

    function showToast(msg) {
        const t = document.getElementById("toast");
        t.innerText = msg; t.className = "show";
        setTimeout(() => t.className = t.className.replace("show", ""), 2500);
    }

    // --- æœç´¢é€»è¾‘ ---
    document.getElementById('searchInput').addEventListener('input', (e) => {
        const term = e.target.value.toLowerCase().trim();
        
        document.querySelectorAll('.style-card').forEach(card => {
            const match = card.getAttribute('data-search').includes(term);
            card.style.display = match ? 'flex' : 'none';
        });

        // éšè—ç©ºçš„åˆ†ç±»å’ŒåŒºå—
        document.querySelectorAll('.category-container').forEach(cat => {
            const hasVisible = cat.querySelectorAll('.style-card[style="display: flex;"]').length > 0;
            cat.style.display = (term === '' || hasVisible) ? 'block' : 'none';
        });
        document.querySelectorAll('.section-container').forEach(sec => {
            const hasVisible = sec.querySelectorAll('.category-container[style="display: block;"]').length > 0;
            sec.style.display = (term === '' || hasVisible) ? 'block' : 'none';
        });
    });

    // --- ä¸»é¢˜åˆ‡æ¢ ---
    const themeBtn = document.getElementById('themeBtn');
    const htmlEl = document.documentElement;
    
    // è¯»å–è®°å¿†
    const savedTheme = localStorage.getItem('theme') || 'dark';
    setTheme(savedTheme);

    themeBtn.addEventListener('click', () => {
        const newTheme = htmlEl.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        setTheme(newTheme);
    });

    function setTheme(theme) {
        htmlEl.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        document.getElementById('themeIcon').textContent = theme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
    }

    // åˆå§‹åŒ–
    applyPreset();
    renderGallery();

</script>
</body>
</html>